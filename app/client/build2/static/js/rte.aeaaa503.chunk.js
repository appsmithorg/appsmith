"use strict";(self.webpackChunkappsmith=self.webpackChunkappsmith||[]).push([[982],{42900:function(n,o,e){e.r(o),e.d(o,{RichTextEditorInputWrapper:function(){return j},default:function(){return P}});var t,r,i=e(50678),a=e(17186),s=e(72791),l=e(86538),c=e(52007),d=function(){return d=Object.assign||function(n){for(var o,e=1,t=arguments.length;e<t;e++)for(var r in o=arguments[e])Object.prototype.hasOwnProperty.call(o,r)&&(n[r]=o[r]);return n},d.apply(this,arguments)},u={onActivate:c.func,onAddUndo:c.func,onBeforeAddUndo:c.func,onBeforeExecCommand:c.func,onBeforeGetContent:c.func,onBeforeRenderUI:c.func,onBeforeSetContent:c.func,onBeforePaste:c.func,onBlur:c.func,onChange:c.func,onClearUndos:c.func,onClick:c.func,onContextMenu:c.func,onCopy:c.func,onCut:c.func,onDblclick:c.func,onDeactivate:c.func,onDirty:c.func,onDrag:c.func,onDragDrop:c.func,onDragEnd:c.func,onDragGesture:c.func,onDragOver:c.func,onDrop:c.func,onExecCommand:c.func,onFocus:c.func,onFocusIn:c.func,onFocusOut:c.func,onGetContent:c.func,onHide:c.func,onInit:c.func,onKeyDown:c.func,onKeyPress:c.func,onKeyUp:c.func,onLoadContent:c.func,onMouseDown:c.func,onMouseEnter:c.func,onMouseLeave:c.func,onMouseMove:c.func,onMouseOut:c.func,onMouseOver:c.func,onMouseUp:c.func,onNodeChange:c.func,onObjectResizeStart:c.func,onObjectResized:c.func,onObjectSelected:c.func,onPaste:c.func,onPostProcess:c.func,onPostRender:c.func,onPreProcess:c.func,onProgressState:c.func,onRedo:c.func,onRemove:c.func,onReset:c.func,onSaveContent:c.func,onSelectionChange:c.func,onSetAttrib:c.func,onSetContent:c.func,onShow:c.func,onSubmit:c.func,onUndo:c.func,onVisualAid:c.func},p=d({apiKey:c.string,id:c.string,inline:c.bool,init:c.object,initialValue:c.string,onEditorChange:c.func,outputFormat:c.oneOf(["html","text"]),value:c.string,tagName:c.string,cloudChannel:c.string,plugins:c.oneOfType([c.string,c.array]),toolbar:c.oneOfType([c.string,c.array]),disabled:c.bool,textareaName:c.string,tinymceScriptSrc:c.string,rollback:c.oneOfType([c.number,c.oneOf([!1])]),scriptLoading:c.shape({async:c.bool,defer:c.bool,delay:c.number})},u),f=function(n){return"function"===typeof n},h=function(n){return n in u},b=function(n){return n.substr(2)},g=function(n,o,e,t,r){return function(n,o,e,t,r,i,a){var s=Object.keys(r).filter(h),l=Object.keys(i).filter(h),c=s.filter((function(n){return void 0===i[n]})),d=l.filter((function(n){return void 0===r[n]}));c.forEach((function(n){var o=b(n),t=a[o];e(o,t),delete a[o]})),d.forEach((function(e){var r=t(n,e),i=b(e);a[i]=r,o(i,r)}))}(r,n.on.bind(n),n.off.bind(n),(function(o,e){return function(t){var r;return null===(r=o(e))||void 0===r?void 0:r(t,n)}}),o,e,t)},v=0,m=function(n){var o=Date.now();return n+"_"+Math.floor(1e9*Math.random())+ ++v+String(o)},y=function(n){return null!==n&&("textarea"===n.tagName.toLowerCase()||"input"===n.tagName.toLowerCase())},w=function(n){return"undefined"===typeof n||""===n?[]:Array.isArray(n)?n:n.split(" ")},x=function(){return{listeners:[],scriptId:m("tiny-script"),scriptLoading:!1,scriptLoaded:!1}},C=function(){var n=x();return{load:function(o,e,t,r,i,a){var s=function(){return function(n,o,e,t,r,i){var a=o.createElement("script");a.referrerPolicy="origin",a.type="application/javascript",a.id=n,a.src=e,a.async=t,a.defer=r,a.addEventListener("load",(function n(){a.removeEventListener("load",n),i()})),o.head&&o.head.appendChild(a)}(n.scriptId,o,e,t,r,(function(){n.listeners.forEach((function(n){return n()})),n.scriptLoaded=!0}))};n.scriptLoaded?a():(n.listeners.push(a),n.scriptLoading||(n.scriptLoading=!0,i>0?setTimeout(s,i):s()))},reinitialize:function(){n=x()}}}(),k=function(){var n="undefined"!==typeof window?window:e.g;return n&&n.tinymce?n.tinymce:null},E=function(){var n=function(o,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var e in o)Object.prototype.hasOwnProperty.call(o,e)&&(n[e]=o[e])},n(o,e)};return function(o,e){if("function"!==typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=o}n(o,e),o.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}}(),D=function(){return D=Object.assign||function(n){for(var o,e=1,t=arguments.length;e<t;e++)for(var r in o=arguments[e])Object.prototype.hasOwnProperty.call(o,r)&&(n[r]=o[r]);return n},D.apply(this,arguments)},_=function(){var n,o,e;return(null===(e=null===(o=null===(n=k())||void 0===n?void 0:n.Env)||void 0===o?void 0:o.browser)||void 0===e?void 0:e.isIE())?"change keyup compositionend setcontent":"change input compositionend setcontent"},B=function(){return window.InputEvent&&"function"===typeof InputEvent.prototype.getTargetRanges?"beforeinput SelectionChange":"SelectionChange"},S=function(n){function o(o){var e,t,r,i=n.call(this,o)||this;return i.rollbackTimer=void 0,i.valueCursor=void 0,i.rollbackChange=function(){var n=i.editor,o=i.props.value;n&&o&&o!==i.currentContent&&n.undoManager.ignore((function(){if(n.setContent(o),i.valueCursor&&(!i.inline||n.hasFocus()))try{n.selection.moveToBookmark(i.valueCursor)}catch(e){}})),i.rollbackTimer=void 0},i.handleBeforeInput=function(n){if(void 0!==i.props.value&&i.props.value===i.currentContent&&i.editor&&(!i.inline||i.editor.hasFocus))try{i.valueCursor=i.editor.selection.getBookmark(3)}catch(o){}},i.handleBeforeInputSpecial=function(n){"Enter"!==n.key&&"Backspace"!==n.key&&"Delete"!==n.key||i.handleBeforeInput(n)},i.handleEditorChange=function(n){var o=i.editor;if(o&&o.initialized){var e=o.getContent();if(void 0!==i.props.value&&i.props.value!==e&&!1!==i.props.rollback&&(i.rollbackTimer||(i.rollbackTimer=window.setTimeout(i.rollbackChange,"number"===typeof i.props.rollback?i.props.rollback:200))),e!==i.currentContent&&(i.currentContent=e,f(i.props.onEditorChange))){var t=i.props.outputFormat,r="html"===t?e:o.getContent({format:t});i.props.onEditorChange(r,o)}}},i.handleEditorChangeSpecial=function(n){"Backspace"!==n.key&&"Delete"!==n.key||i.handleEditorChange(n)},i.initialise=function(n){var o,e,t;void 0===n&&(n=0);var r=i.elementRef.current;if(r)if(function(n){if(!("isConnected"in Node.prototype)){for(var o=n,e=n.parentNode;null!=e;)e=(o=e).parentNode;return o===n.ownerDocument}return n.isConnected}(r)){var a=k();if(!a)throw new Error("tinymce should have been loaded into global scope");var s,l,c=D(D({},i.props.init),{selector:void 0,target:r,readonly:i.props.disabled,inline:i.inline,plugins:(s=null===(o=i.props.init)||void 0===o?void 0:o.plugins,l=i.props.plugins,w(s).concat(w(l))),toolbar:null!==(e=i.props.toolbar)&&void 0!==e?e:null===(t=i.props.init)||void 0===t?void 0:t.toolbar,setup:function(n){i.editor=n,i.bindHandlers({}),i.inline&&!y(r)&&n.once("PostRender",(function(o){n.setContent(i.getInitialValue(),{no_events:!0})})),i.props.init&&f(i.props.init.setup)&&i.props.init.setup(n)},init_instance_callback:function(n){var o,e,t=i.getInitialValue();i.currentContent=null!==(o=i.currentContent)&&void 0!==o?o:n.getContent(),i.currentContent!==t&&(i.currentContent=t,n.setContent(t),n.undoManager.clear(),n.undoManager.add(),n.setDirty(!1));var r=null!==(e=i.props.disabled)&&void 0!==e&&e;n.setMode(r?"readonly":"design"),i.props.init&&f(i.props.init.init_instance_callback)&&i.props.init.init_instance_callback(n)}});i.inline||(r.style.visibility=""),y(r)&&(r.value=i.getInitialValue()),a.init(c)}else if(0===n)setTimeout((function(){return i.initialise(1)}),1);else{if(!(n<100))throw new Error("tinymce can only be initialised when in a document");setTimeout((function(){return i.initialise(n+1)}),100)}},i.id=i.props.id||m("tiny-react"),i.elementRef=s.createRef(),i.inline=null!==(r=null!==(e=i.props.inline)&&void 0!==e?e:null===(t=i.props.init)||void 0===t?void 0:t.inline)&&void 0!==r&&r,i.boundHandlers={},i}return E(o,n),o.prototype.componentDidUpdate=function(n){var o,e,t=this;if(this.rollbackTimer&&(clearTimeout(this.rollbackTimer),this.rollbackTimer=void 0),this.editor&&(this.bindHandlers(n),this.editor.initialized)){if(this.currentContent=null!==(o=this.currentContent)&&void 0!==o?o:this.editor.getContent(),"string"===typeof this.props.initialValue&&this.props.initialValue!==n.initialValue)this.editor.setContent(this.props.initialValue),this.editor.undoManager.clear(),this.editor.undoManager.add(),this.editor.setDirty(!1);else if("string"===typeof this.props.value&&this.props.value!==this.currentContent){var r=this.editor;r.undoManager.transact((function(){var n;if(!t.inline||r.hasFocus())try{n=r.selection.getBookmark(3)}catch(s){}var o=t.valueCursor;if(r.setContent(t.props.value),!t.inline||r.hasFocus())for(var e=0,i=[n,o];e<i.length;e++){var a=i[e];if(a)try{r.selection.moveToBookmark(a),t.valueCursor=a;break}catch(s){}}}))}if(this.props.disabled!==n.disabled){var i=null!==(e=this.props.disabled)&&void 0!==e&&e;this.editor.setMode(i?"readonly":"design")}}},o.prototype.componentDidMount=function(){var n,o,e,t,r,i;null!==k()?this.initialise():this.elementRef.current&&this.elementRef.current.ownerDocument&&C.load(this.elementRef.current.ownerDocument,this.getScriptSrc(),null!==(o=null===(n=this.props.scriptLoading)||void 0===n?void 0:n.async)&&void 0!==o&&o,null!==(t=null===(e=this.props.scriptLoading)||void 0===e?void 0:e.defer)&&void 0!==t&&t,null!==(i=null===(r=this.props.scriptLoading)||void 0===r?void 0:r.delay)&&void 0!==i?i:0,this.initialise)},o.prototype.componentWillUnmount=function(){var n=this,o=this.editor;o&&(o.off(_(),this.handleEditorChange),o.off(B(),this.handleBeforeInput),o.off("keypress",this.handleEditorChangeSpecial),o.off("keydown",this.handleBeforeInputSpecial),o.off("NewBlock",this.handleEditorChange),Object.keys(this.boundHandlers).forEach((function(e){o.off(e,n.boundHandlers[e])})),this.boundHandlers={},o.remove(),this.editor=void 0)},o.prototype.render=function(){return this.inline?this.renderInline():this.renderIframe()},o.prototype.renderInline=function(){var n=this.props.tagName,o=void 0===n?"div":n;return s.createElement(o,{ref:this.elementRef,id:this.id})},o.prototype.renderIframe=function(){return s.createElement("textarea",{ref:this.elementRef,style:{visibility:"hidden"},name:this.props.textareaName,id:this.id})},o.prototype.getScriptSrc=function(){if("string"===typeof this.props.tinymceScriptSrc)return this.props.tinymceScriptSrc;var n=this.props.cloudChannel;return"https://cdn.tiny.cloud/1/"+(this.props.apiKey?this.props.apiKey:"no-api-key")+"/tinymce/"+n+"/tinymce.min.js"},o.prototype.getInitialValue=function(){return"string"===typeof this.props.initialValue?this.props.initialValue:"string"===typeof this.props.value?this.props.value:""},o.prototype.bindHandlers=function(n){var o=this;if(void 0!==this.editor){g(this.editor,n,this.props,this.boundHandlers,(function(n){return o.props[n]}));var e=function(n){return void 0!==n.onEditorChange||void 0!==n.value},t=e(n),r=e(this.props);!t&&r?(this.editor.on(_(),this.handleEditorChange),this.editor.on(B(),this.handleBeforeInput),this.editor.on("keydown",this.handleBeforeInputSpecial),this.editor.on("keyup",this.handleEditorChangeSpecial),this.editor.on("NewBlock",this.handleEditorChange)):t&&!r&&(this.editor.off(_(),this.handleEditorChange),this.editor.off(B(),this.handleBeforeInput),this.editor.off("keydown",this.handleBeforeInputSpecial),this.editor.off("keyup",this.handleEditorChangeSpecial),this.editor.off("NewBlock",this.handleEditorChange))}},o.propTypes=p,o.defaultProps={cloudChannel:"5"},o}(s.Component),I=e(16054),R=e(98132),O=e(53979),T=e(80184),M=l.ZP.div(t||(t=(0,a.Z)(["\n  && {\n    width: 100%;\n    height: 100%;\n    .tox .tox-editor-header {\n      z-index: 0;\n    }\n\n    .tox-tinymce {\n      border-radius: ",";\n      box-shadow: "," !important;\n    }\n  }\n  .tox {\n    font-family: inherit;\n\n    width: 100%;\n    .tox-tbtn {\n      cursor: pointer;\n      .tox-tbtn__select-label {\n        cursor: inherit;\n      }\n    }\n  }\n\n  .tox .tox-toolbar__primary {\n    background: ",";\n  }\n\n  .tox .tox-edit-area__iframe {\n    background: ",";\n  }\n\n  .tox-tinymce {\n    border: 1px solid\n      ",";\n  }\n\n  &.disabled {\n    cursor: not-allowed !important;\n  }\n\n  &.disabled .tox {\n    pointer-events: none;\n  }\n\n  &:not(.disabled):hover .tox-tinymce {\n    border: 1px solid\n      ",";\n  }\n\n  .tox .tox-statusbar {\n    background: ",';\n  }\n\n  .tox:not([dir="rtl"]) .tox-toolbar__group:not(:last-of-type) {\n    border-right: none;\n    border-bottom: none;\n    position: relative;\n\n    &::after {\n      content: "";\n      height: 39px;\n      width: 1px;\n      position: absolute;\n      right: 0;\n      background: var(--wds-color-border);\n    }\n  }\n\n  .tox:not([dir="rtl"]) .tox-toolbar__group:not(:last-of-type),\n  .tox .tox-statusbar {\n    border-color: var(--wds-color-border);\n  }\n\n  .tox .tox-tbtn svg,\n  #tox-icon-highlight-bg-color__color,\n  #tox-icon-text-color__color {\n    fill: ',";\n  }\n\n  .tox .tox-tbtn {\n    margin: 3px 0 2px 0;\n    border-radius: ",";\n\n    &:hover {\n      background: var(--wds-color-bg-hover);\n    }\n  }\n\n  .tox .tox-toolbar,\n  .tox .tox-toolbar__overflow {\n    background: linear-gradient(\n      to bottom,\n      var(--wds-color-border) 1px,\n      transparent 1px\n    );\n    background-color: ",";\n    background-size: auto 39px;\n  }\n\n  .tox-editor-header {\n    border-bottom: 1px solid var(--wds-color-border);\n  }\n\n  .tox-tbtn__select-label {\n    color: ",";\n  }\n\n  .tox .tox-split-button {\n    margin: 3px 0 2px 0;\n    border-radius: ",";\n\n    &:hover {\n      box-shadow: 0 0 0 1px var(--wds-color-border) inset;\n    }\n    &:focus {\n      background: var(--wds-color-bg-focus);\n    }\n    &:active {\n      background: var(--wds-color-bg-focus);\n    }\n  }\n\n  .tox .tox-tbtn:focus:not(.tox-tbtn--disabled) {\n    background: var(--wds-color-bg-selected);\n  }\n\n  .tox .tox-tbtn:active:not(.tox-tbtn--disabled) {\n    background: var(--wds-color-bg-focus);\n  }\n\n  .tox .tox-split-button__chevron {\n    width: 24px;\n    padding-right: 0px;\n  }\n\n  .tox .tox-tbtn--enabled {\n    background: var(--wds-color-bg-focus);\n    color: var(--wds-color-text);\n\n    .tox-tbtn svg,\n    .tox-tbtn__icon-wrap svg,\n    #tox-icon-highlight-bg-color__color,\n    #tox-icon-text-color__color {\n      fill: ",";\n    }\n  }\n\n  .tox .tox-toolbar__group {\n    height: 39px;\n  }\n\n  .tox .tox-tbtn--disabled svg,\n  .tox .tox-tbtn--disabled:hover svg,\n  .tox .tox-tbtn:disabled svg,\n  .tox .tox-tbtn:disabled:hover svg {\n    fill: var(--wds-color-icon-disabled);\n  }\n\n  ","\n"])),(function(n){return n.borderRadius}),(function(n){var o=n.boxShadow;return"".concat(o)}),(function(n){return n.isDisabled?"var(--wds-color-bg-disabled)":"var(--wds-color-bg)"}),(function(n){return n.isDisabled?"var(--wds-color-bg-disabled)":"var(--wds-color-bg)"}),(function(n){return n.isValid?"var(--wds-color-border)":"var(--wds-color-border-danger)"}),(function(n){return n.isValid?"var(--wds-color-border-hover)":"var(--wds-color-border-danger-hover)"}),(function(n){return n.isDisabled?"var(--wds-color-bg-disabled)":"var(--wds-color-bg)"}),(function(n){return n.isDisabled?"var(--wds-color-icon-disabled)":"var(--wds-color-icon)"}),(function(n){return n.borderRadius}),(function(n){return n.isDisabled?"var(--wds-color-bg-disabled)":"var(--wds-color-bg)"}),(function(n){return n.isDisabled?"var(--wds-color-text-disabled)":"var(--wds-color-text)"}),(function(n){return n.borderRadius}),(function(n){return n.isDisabled?"var(--wds-color-icon-disabled)":"var(--wds-color-text)"}),I.zO),j=l.ZP.div(r||(r=(0,a.Z)(["\n  display: flex;\n  width: 100%;\n  min-width: 0;\n  height: 100%;\n  border-radius: ",";\n\n  ",";\n"])),(function(n){return n.borderRadius}),(function(n){return n.isDynamicHeightEnabled?"&& { height: auto; min-height: 192px; }":""}));var P=function(n){var o=n.compactMode,e=n.isDisabled,t=n.isDynamicHeightEnabled,r=n.labelAlignment,a=n.labelPosition,l=n.labelStyle,c=n.labelText,d=n.labelTextColor,u=n.labelTextSize,p=n.labelWidth,f=(0,s.useState)(n.value),h=(0,i.Z)(f,2),b=h[0],g=h[1],v=(0,s.useRef)(!0),m=(0,s.useCallback)((function(o,e){o!==b&&(e.hasFocus()&&(g(o),n.onValueChange(o)))}),[n.onValueChange,b]);return(0,s.useEffect)((function(){v.current||b===n.value?v.current=!1:g(n.value)}),[n.value]),(0,T.jsxs)(M,{borderRadius:n.borderRadius,boxShadow:n.boxShadow,className:"container-".concat(n.widgetId," ").concat(n.isDisabled?"disabled":""),compactMode:o,"data-testid":"rte-container",isDisabled:n.isDisabled,isDynamicHeightEnabled:t,isValid:n.isValid,labelPosition:a,children:[c&&(0,T.jsx)(O.ZP,{alignment:r,className:"rich-text-editor-label",color:d,compact:o,disabled:e,fontSize:u,fontStyle:l,isDynamicHeightEnabled:t,position:a,text:c,width:p}),(0,T.jsx)(j,{borderRadius:n.borderRadius,isDynamicHeightEnabled:t,isValid:n.isValid,children:(0,T.jsx)(S,{disabled:n.isDisabled,id:"rte-".concat(n.widgetId),init:{height:t?"auto":"100%",menubar:!1,toolbar_mode:"sliding",forced_root_block:"p",branding:!1,resize:!1,browser_spellcheck:!0,content_style:"".concat(":root {\n  --wds-color-border: #E0DEDE;\n  --wds-color-border-onaccent: rgba(161, 161, 161, 0.3);\n  --wds-color-border-light: #FDDDDD;\n  --wds-color-border-hover: #B3B3B3;\n  --wds-color-border-disabled: #E0DEDE;\n  --wds-color-border-danger: #D91921;\n  --wds-color-border-danger-hover: #B90707;\n  --wds-color-border-danger-focus: #B90707;\n  --wds-color-border-danger-focus-light: #fedddd;\n\n  --wds-color-bg: #FFFFFF;\n  --wds-color-bg-hover: #EBEBEB;\n  --wds-color-bg-selected: #EBEBEB;\n  --wds-color-bg-focus: #e3e3e3;\n  --wds-color-bg-light: #EBEBEB;\n  --wds-color-bg-strong: #E0DEDE;\n  --wds-color-bg-strong-hover: #B3B3B3;\n  --wds-color-bg-disabled: #F3F3F3;\n  --wds-color-bg-disabled-light: #E0DEDE;\n  --wds-color-bg-disabled-strong: #A9A7A7;\n  --wds-color-bg-danger: #D91921;\n  --wds-color-bg-danger-hover: #B90707;\n\n  --wds-color-icon: #858282;\n  --wds-color-icon-disabled: #A9A7A7;\n  --wds-color-icon-hover: #4B4848;\n\n  --wds-color-text: #090707;\n  --wds-color-text-danger: #D91921;\n  --wds-color-text-light: #716E6E;\n  --wds-color-text-disabled: #A9A7A7;\n  --wds-color-text-disabled-light: #CAC7C7;\n}\n\n","\n            * {\n              color: ").concat(n.isDisabled?"var(--wds-color-text-disabled)":"var(--wds-color-text)",";\n            }"),plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table paste code help"],contextmenu:"link useBrowserSpellcheck image table",setup:function(n){n.ui.registry.addMenuItem("useBrowserSpellcheck",{text:'Use "'.concat((0,R.Q5)()?"Control":"Ctrl",' + Right click" to access spellchecker'),onAction:function(){n.notificationManager.open({text:"To access the spellchecker, hold the ".concat((0,R.Q5)()?"Control":"Ctrl"," key and right-click on the misspelt word."),type:"info",timeout:5e3,closeButton:!0})}}),n.ui.registry.addContextMenu("useBrowserSpellcheck",{update:function(){return n.selection.isCollapsed()?["useBrowserSpellcheck"]:[]}})}},onEditorChange:m,tinymceScriptSrc:"https://cdnjs.cloudflare.com/ajax/libs/tinymce/5.10.1/tinymce.min.js",toolbar:!n.isToolbarHidden&&"insertfile undo redo | formatselect | bold italic backcolor forecolor | lineheight | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image | removeformat | table | print preview media | forecolor backcolor emoticons' |help",value:b},"editor_".concat(n.isToolbarHidden,"_").concat(n.isDisabled))})]})}}}]);
//# sourceMappingURL=rte.aeaaa503.chunk.js.map