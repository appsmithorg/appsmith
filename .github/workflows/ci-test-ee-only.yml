name: Appsmith CI Test Workflow for EE only file changes

on:
  # This line enables manual triggering of this workflow.
  workflow_dispatch:
  workflow_call:
    inputs:
      pr:
        description: "This is the PR number in case the workflow is being called in a pull request"
        required: false
        type: number

jobs:
  changed_files:
    runs-on: ubuntu-latest
    name: Test changed-files
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0

      - name: Get changed files in the client/src/** folder
        id: changed-files-specific
        uses: tj-actions/changed-files@v41
        with:
          files: client/src/**
          files_ignore: client/src/ee/**

      - name: Run step if any file(s) in the client folder change except for files in the client/src/ee folder
        if: steps.changed-files-specific.outputs.any_changed == 'true'
        run: |
          echo "One or more files in the client/src/** folder has changed which should be changed on CE repo instead ðŸ”´"
          echo "List all the files that have changed: ${{ steps.changed-files-specific.outputs.all_changed_files }}"
          exit 1
