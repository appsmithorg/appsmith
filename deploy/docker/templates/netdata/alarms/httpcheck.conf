template: httpcheck_web_service_timeouts
 families: *
       on: httpcheck.status
    class: Web Server
component: HTTP endpoint
     type: Latency
   lookup: average -5m unaligned percentage of timeout
    every: 10s
    units: %
     info: average ratio of HTTP request timeouts over the last 5 minutes

 template: httpcheck_no_web_service_connections
 families: *
       on: httpcheck.status
    class: Other
component: HTTP endpoint
     type: Errors
   lookup: average -5m unaligned percentage of no_connection
    every: 10s
    units: %
     info: average ratio of failed requests during the last 5 minutes

# combined timeout & no connection alarm
 template: httpcheck_web_service_unreachable
 families: *
       on: httpcheck.status
    class: Web Server
component: HTTP endpoint
     type: Errors
     calc: ($httpcheck_no_web_service_connections >= $httpcheck_web_service_timeouts) ? ($httpcheck_no_web_service_connections) : ($httpcheck_web_service_timeouts)
    units: %
    every: 10s
     warn: ($httpcheck_no_web_service_connections >= 10 OR $httpcheck_web_service_timeouts >= 10) AND ($httpcheck_no_web_service_connections < 40 OR $httpcheck_web_service_timeouts < 40)
     crit: $httpcheck_no_web_service_connections >= 40 OR $httpcheck_web_service_timeouts >= 40
    delay: down 5m multiplier 1.5 max 1h
     info: ratio of failed requests either due to timeouts or no connection over the last 5 minutes
  options: no-clear-notification
       to: webmaster